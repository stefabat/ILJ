\documentclass[utf8]{article}

\usepackage{preamble}

\graphicspath{{figures/}}
\makeatletter
\def\input@path{{figures/}{tables/}}
\makeatother

\input{figures}
\input{tables}

\title{\LARGE Static and Dynamics of the Azide Anion Confined in an Armchair Carbon Nanotube}

\author{Stefano Battaglia}

\begin{document}

\maketitle

\section{Introduction}
Introduction

\section{Computational Details}
The computational details section is divided in two parts.
The first one describes the details of the \textit{ab-initio} calculations performed in order to obtain accurate interaction energies and partial atomic charges of the two fragments.
The second one describes the analytical potential employed in the molecular dynamics (MD) simulations and assesses its performance against the \textit{ab-initio} values.


\subsection{\textit{Ab-Initio}}
At \textit{ab-initio} level, carbon nanotubes (CNTs) have been treated as finite-size systems and the two open ends have been capped with hydrogen atoms in order to fill out the valence shell. Only one type of armchair nanotube has been considered, with chiral indices $(5,5)$. In order to obtain converged values with respect to the length of the nanotube, CNTs with different number of units have been studied. We introduce here the notation $\Lambda$-$(5,5)$CNT to label a nanotube composed by $\Lambda$ units, where a single unit corresponds to a [$10$]cyclophenacene (see FIGURE).


\subsubsection{Geometries}
The geometries of the nanotubes and the azide anion have been optimized using restricted Kohn-Sham density functional theory (DFT), employing the B97D3 exchange-correlation functional with Becke-Johnson damping\cite{Grimme2010,Grimme2011}.
For both fragments Dunning's triple-$\zeta$ cc-pVTZ basis set\cite{DunningJr1989} has been used, with the addition of diffuse functions (aug-)\cite{Kendall1992} in the case of the \ntm fragment.\\
The nanotubes geometries retained the high $D_{5d}$ symmetry, with both parallel and perpendicular (to the principal axis) C--C bonds showing the typical alternation pattern of these systems when treated with open boundary conditions\cite{Zhou2004,Galano2006}. As the length of the nanotube increases, the average C--C bond length also increases, from $1.4237$ \AA\ to $1.4268$ \AA, which is in agreement with the fact that the bond gets slightly stretched due to the curvature.\\
The relaxed \ntm geometry has linear $D_{\infty h}$ symmetry, with an N--N bond length of $1.1874$ \AA, which is in excellent agreement with the experimental gas phase value of $1.1884$ \AA\cite{Polak1987}.\\
All the optimizations just mentioned have been performed using the Gaussian 09 software package, revision d01\cite{g09}, using the default convergence thresholds, the ultrafine grid for the integral quadrature and spherical \textit{d} and \textit{f} basis functions.


\subsubsection{Interaction Energies}
In order to construct the classical force field (cf. Molecular Dynamics section), the most important parameter to obtain is the interaction energy of the the guest \ntm ion and the host carbon nanotube at the optimal adsorption distance.
In this contribution, all interaction energies computed using first principles methods have been evaluated according to the formula
%
\begin{equation}
    E_{int} = E_{complex} - (E_{cnt} + E_{azide}) \label{eq:eint}
\end{equation}
%
where the fragment energies $E_{cnt}$ and $E_{azide}$ have been computed in the basis set of the complex system, thus correcting the basis set superposition error according to the Boys and Bernardi scheme\cite{Boys1970}.
Relaxation effects on the two interacting fragments have not been taken into account, although it has been recently shown that they contribute only in the order of 1--2 kcal/mol\cite{Battaglia2017a} to $E_{int}$ and thus do not substantially modify the overall picture.\\
To locate the minimum of the potential energy surface (PES), a series of constrained optimizations involving nanotubes of lengths between 3 and 9 units has been performed. In these optimizations, the optimal geometry of the two fragments has been kept frozen and only their relative distance and orientation have been optimized, thus locating the adsorption distance.
This series of optimizations has been performed using the ORCA 4 program package\cite{ORCA} at the same level of theory as before, besides employing the smaller cc-pVDZ basis set on the nanotube, the resolution of the identity technique for the Coulomb matrix using the auxiliary basis def2/J by Weigend \textit{et al.}\cite{Weigend2006}.\\
Remarkably, it turns out that in the particular case of an azide anion confined inside a $(5,5)$CNT, the geometry with the \ntm molecule placed exactly in the center of the nanotube, aligned to its principal axis, results to be a local minimum. Moreover, the difference between this minimum and the lowest minimum found is at most less than $0.6$ kcal/mol for the nanotubes studied. For this reason, the geometry with the \ntm molecule placed in the center of the CNTs has been used for the calculation of $E_{int}$ at higher levels of theory and for nanotubes longer than 9 units.
For a detailed explanation of the structure optimizations, the criteria used to compare them and all the geometries, we point the reader to the Supplementary Information.\\

%%%%
As we are dealing with finite size CNTs, it is important to study the dependence of the interaction energy with respect to the length of the nanotube. In particular, given that the confined species is negatively charged, one expects a slower convergence compared to neutral systems due to the typically more diffuse electron density of anions.\\
Accurate interaction energies have been calculated at wave function level of theory, using the density-fitted spin-component-scaled MP2 method (RI-SCS-MP2)[REFERENCE] and the local coupled cluster method DLPNO-CCSD(T) as implemented in the ORCA 4 program package\cite{Riplinger2013,Riplinger2016}. Calculations have been performed using the cc-pVDZ or the cc-pVTZ basis set (where computationally feasible) and in both cases diffuse functions (aug-) have been added on the \ntm species.\\
\fref{fig:n3t55x_ab-initio_eint} depicts the results obtained for nanotubes of different lengths, where it is immediately clear that interaction energy shows a slow convergence rate with respect to $\Lambda$.
In order to obtain accurate interaction energies within a sufficiently large basis set, extrapolated DLPNO-CCSD(T)/cc-pVTZ values have been obtained using the following formula
%
\begin{equation}
    E_{CC}(pVTZ) \approx E_{MP2}(pVTZ) + (E_{CC}(pVDZ) - E_{MP2}(pVDZ)) \label{eq:basis_extr}
\end{equation}
%
where it is assumed that the correlation energy difference between the two methods is constant with respect to the basis set used.
This approach has allowed us to obtain approximate accurate values for nanotubes of length 3, 5 and 7. Nonetheless, as it can be seen from the RI-SCS-MP2/cc-pVDZ curve in \Cref{fig:n3t55x_ab-initio_eint}, $E_{int}$ still significantly decreases with the addition of extra nanotube units.
Therefore, in order to be able to extrapolate the DLPNO-CCSD(T)/cc-pVTZ confinement energy inside an arbitrary $\Lambda$-(5,5) nanotube we use the following formula
%
\begin{equation}
    E_{int}(\Lambda) = \frac{a\Lambda}{b + \Lambda} \label{eq:length_extr}
\end{equation} 
%
where $a$ and $b$ are two fitting parameters to be determined.
\Cref{eq:length_extr} is the simplest formula which satisfies the condition $E_{int}(0) = 0$ and provides an estimate for the infinitely long nanotube through the parameter $a$.\\
The solid lines in \Cref{fig:n3t55x_ab-initio_eint} show the non-linear least square fits to the RI-SCS-MP2/cc-pVDZ and the approximated DLPNO-CCSD(T)/cc-pVTZ interaction energies computed according to \cref{eq:basis_extr}.
The extrapolated value for $E_{int}$ in the limit of an infinitely long CNT is $-65.93$ kcal/mol.
For a detailed explanation of the parameters used in the calculation and the tests performed to assess the validity of our approach, we point the reader to the Supplementary Information.\\


\subsection{Molecular Dynamics}
The Improved Lennard-Jones (ILJ) potential\cite{Pirani2008} is given by
%
\begin{equation}
    V_{ILJ}(r_{ij}) = \epsilon \left[ \frac{m}{n(r_{ij})-m} \cdot \Big( \frac{r_0}{r_{ij}} \Big)^{n(r_{ij})} -
                                 \frac{n(r_{ij})}{n(r_{ij})-m} \cdot \Big( \frac{r_0}{r_{ij}} \Big)^{m} \right]
\end{equation}
%
where
%
\begin{equation}
    n(r_{ij}) = \beta + 4.0 \cdot \Big( \frac{r_{ij}}{r_0} \Big)^2
\end{equation}
%
and $r_{ij}$ is the distance between atom $i$ in the carbon nanotube and atom $j$ in the \ntm molecule. The parameters $r_0$ and $\epsilon$ are set according to the atoms interacting, $\beta$ is a free parameter used to fit the potential to experimental or numerical values, while $m$ is set according the to the partial charges of the interacting species.
Since the azide anion has a total negative charge of $-1$, one has to introduce a non-bonded term in the potential which accounts for the induced polarization on the carbon nanotube due to the excess negative charge of the anion.
The potential term $V_{ind}$ describing the dipole induced by the $\text{N}_3^-$ anion on a neutral fragment is given by
%
\begin{equation}
    V_{ind}(r_{i1},r_{i2},r_{i3}) = - \frac{1}{2} \cdot \alpha \cdot f(r_{i1},r_{i2},r_{i3})
                        \left[ \frac{q_1}{r_{i1}^2} + \frac{q_2}{r_{i2}^2} + \frac{q_3}{r_{i3}^2} \right]^2
\end{equation}
%
where $r_{i1}$, $r_{i2}$ and $r_{i3}$ are the distances between atom $i$ of the neutral species and the three nitrogen atoms of the azide anion, $q_1$, $q_2$ and $q_3$ are the partial charges on the nitrogen atoms, $\alpha$ is the polarizability per volume of the atoms in the neutral species and $f(r_{i1},r_{i2},r_{i3})$ is a damping factor.\\  % $f(R_{i,2}) = \frac{n(R_{i,2})}{n(R_{i,2}) - 4}$
By saturating the CNT with hydrogen atoms, the two ends of the nanotube result significantly polarized with partial atomic charges in the range of $\pm 0.2$.
As a consequence, the \ntm interacts through the usual Coulomb potential with the partial atomic charges on the nanotube, giving rise to an additional term $V_{els}$ describing this electrostatic potential as
%
\begin{equation}
    V_{els}(r_{ij}) = \frac{q_i q_j}{r_{ij}}
\end{equation}
%
This \textit{artificial} term vanishes when hydrogen atoms are removed from the nanotube or the nanotube is considered with periodic boundary conditions. This follows from the fact that the partial atomic charge on each carbon atom is equal zero ($q_i \equiv 0$ $\forall i$) and thus $V_{els}(r_{ij}) = 0$.\\

The total interaction energy $E_{int}$ is finally obtained by summing the potential terms just described over all atoms of both fragments as follows
%
\begin{align}
    E_{int} = \sum_{i=1}^{N_C + N_H} V^{(i)}_{ind}(r_{i1},r_{i2},r_{i3}) +
              \sum_{j=1}^{N_N} V_{ILJ}^{(ij)}(r_{ij}) + V_{els}(r_{ij})
\end{align}
%
where $N_C$, $N_N$ and $N_H$ correspond to the total number of carbon, nitrogen and hydrogen atoms, respectively.
The superscript $(ij)$ in the ILJ potential term $V_{ILJ}^{(ij)}$ keeps track of the interacting atom types such that the parameters can be accordingly set to the values given in \tref{tab:ILJ_parms}.
The ILJ parameters have been obtained following the approach illustrated in Ref. \citenum{Cambi1991}, which is based on the static atomic dipole polarizabilities of the interacting fragments.
For hydrogen and carbon, the polarizabilities were taken from Refs. \citenum{Gavezzotti2003} and \citenum{Torrens2004}, while for nitrogen, the \ntm experimental total mean polarizability\cite{Borgne1999}, $\bar{\alpha} = 4.65$ \AA$^3$, has been distributed on the three atoms according to their partial charges.
All values are listed in \tref{tab:polarizabilities}.
The partial atomic charges on the azide anion were set to be $q_1 = q_3 = -0.56$ and $q_2 = 0.12$, while for the carbon nanotube they have been obtained through a natural population analysis\cite{Reed1985a} of the electron density calculated at B97D3/cc-pVTZ level of theory.\\
Additional information on the atomic polarizabilities and the procedure used to obtain the ILJ parameters is available in the Supplementary Information.\\

In \fref{fig:n3t55x_comp_eint} it can be seen the direct comparison of the \emph{ab-initio} and the classical potential ($\beta = 8$ and $f(r_{i1},r_{i2},r_{i3}) = 1$) for nanotubes with $\Lambda = 3,5,7,9,11,13$. 
The various components of the classical potential can also be considered separately, and these are listed in \tref{tab:pot_comp} and plotted in \fref{fig:n3t55x_classical_eint} along with the total and the \emph{ab-initio} ones.

\clearpage

\bibliographystyle{unsrt}
\bibliography{library}

\clearpage
\section{Supplementary Information}

\subsection{Geometry Optimization}
To ensure that the relaxation process did not remain trapped in a local minimum and without knowing a priori the optimal adsorption distance of the \ntm molecule, the optimization procedure has been started from four different geometries.
In all cases, the anion has been placed parallel to the principal axis of the nanotube.
Three starting geometries were chosen according to possible adsorption sites in which the central nitrogen atom of the azide was placed either over C--C bonds (\textit{bond} (b) and \textit{zigzag} (z) geometries) or in the center of an hexagonal ring of the CNT wall (\textit{hollow} (h) geometry). The three starting sites are shown in \fref{fig:n3t553_start_sites}, along with their labels that will be used in the following to refer to them. For all three cases, the azide anion has been placed at a distance of about $2.25$\AA\ from the nanotube wall.
The fourth starting geometry is shown in \fref{fig:n3t553_start_center} and it simply consists in the \ntm anion placed exactly in the center of the nanotube. We will refer to this starting geometry as \textit{central} (c) geometry.
In order to study the edge effects on the position of the minimum, CNTs of four different lengths have been considered, namely with 3, 5, 7 and 9 units.
The relaxed structures starting from the (c) geometry correspond to a (local) minimum, since after one optimization step the convergence is reached, with the \ntm anion insignificantly ($\approx 0.002$\AA) shifted out of the principal axis. For this reason we will consider from now on the (c) geometry as the perfectly aligned anion to the principal axis and sitting in the center of the nanotube.
For the three other starting conformations, namely the the (b), (h) and (z) geometries, the relaxation leads to different (local) minima.
In order to analyze the differences in the final structures, three geometrical parameters and an energetic one have been considered.
The geometrical parameters are depicted in \fref{fig:n3t553_geom_parms} and consist in the axial distance $d_{cm}$ between the center of mass of the azide anion and the center of mass of the carbon nanotube, the radial distance $r_{axis}$ of the azide anion center of mass from the principal axis of the nanotube and the angle $\theta$ formed between the principal axis and an imaginary line passing through the external nitrogen atoms of the azide anion.
The energetic parameter is the interaction energy $E_{int}$ between the two fragments, computed according to \Cref{eq:eint}.\\
The geometrical parameters computed for all systems are listed in \tref{tab:geom_comp}. Since the (c) geometry consists in the azide ion sitting in the exact center of the nanotube, the three conformational parameters are all zero in that case, thus for geometries (b), (h) and (z), the parameters can be considered as deviations from the (c) geometry. Accordingly, instead of tabulating the interaction energy for every geometry, the values listed in the last column of \Cref{tab:geom_comp} correspond to the interaction energy difference between the (c) geometry and the other three, i.e. $\Delta E_{int} = E_{int}(c) - E_{int}(site)$. A negative value for $\Delta E_{int}$ means that the interaction energy is more favorable (i.e. stronger) for the (c) geometry, while a positive value the opposite.\\
For all final geometries, the azide anion is found to be almost perfectly aligned to the principal axis of the nanotube since the angle $\theta$ is always very small (below $1^{\circ}$ except in one case).
Similarly, $r_{axis}$ is also always particularly small (most of the times below $0.01$ \AA), meaning that the anion has the preference to stay approximately at the same distance from the nanotube wall in all directions.
In particular, irrespective of the length $\Lambda$, the azide ion is adsorbed at a distance of approximately $3.34$ \AA\ (computed as the distance between the \ntm center of mass and the closest side of the wall). This value is significantly larger than the adsorption distance of $3.17$ \AA\ found for the confinement in a larger 3-CNT(6,6), obtained following the same computational procedure.\\
There are two possible explanations for the difference in the adsorption distance. Either the different curvature of the two nanotubes is such that the forces attracting the ion are stronger in the case of the (6,6) CNT, or, in the case of the (5,5) CNT, there is a competition between the attractive forces exerted by the surrounding wall on the azide ion, which eventually stabilizes it at an (almost) equal radial distance in any direction.
The analysis of the curvature effects on the adsorption distance inside the CNT are beyond the scope of this work, and thus not further investigated here.\\
The most fluctuating parameter is $d_{cm}$. Clearly, the periodic atomic pattern of the carbon nanotube makes the potential energy surface (PES) of the complex full of local minima, all of which approximately share the same well depth. Apart from the (z) conformation, for which $d_{cm}$ remains virtually unchanged irrespective of the length, it is hard to rationalize the results for the (b) and (h) cases.
The only exception is found for the 3-CNT(5,5), where the two open ends of the nanotube are so close to the \ntm molecule that the energy barriers to move away from the center are particularly steep and thus confine the azide anion in the center.\\
Nonetheless, although the evident differences between the final geometries, the effects observed on the interaction energy, which is our first and most important parameter, is minimal and most importantly, below chemical accuracy ($\approx 1$ kcal/mol).
As it appears a very hard task to find the \emph{global minimum} for this type of systems and considering the small influence observed on the interaction energy, the central geometry (c) has been used for all interaction energies computed in this work.

\subsection{Interaction Energies}
The parameters obtained through the non-linear least square fits of the RI-SCS-MP2/cc-pVDZ and the approximated DLPNO-CCSD(T)/cc-pVTZ interaction energies are given in \tref{tab:fit_eint}.

Interaction energies have been computed at different levels of theory for the shortest nanotubes and using the B97D3 functional for all the lengths considered in this work. A comprehensive summary of the values obtained can be seen in \tref{tab:all_eint}.\\
The RI-MP2 and DLPNO-MP2 values are used as a reference to check the error introduced by the DLPNO methods.
The suggested threshold[REFERENCE] to obtain very accurate results for non-covalently bounded systems is the ``TightPNO''. Nonetheless, the DLPNO-MP2 interaction energies obtained with the ``NormalPNO'' threshold only show small deviations from the canonical RI-MP2 values. For this reason and considering our computational limitations, the DLPNO-CCSD(T) have also been performed using the ``NormalPNO'' threshold.
We argue that the error introduced by the looser cutoffs is anyway smaller than the error introduced with the classical potential.

\end{document}
